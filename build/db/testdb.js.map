{"version":3,"sources":["../../src/db/testdb.js"],"names":["url","process","env","MONGODB_URI","mongoose","connect","useNewUrlParser","useUnifiedTopology","contactSchema","Schema","_id","String","name","tel","address","photo","photoSchema","image","Buffer","mimetype","options","toObject","set","transform","doc","ret","no","__v","index","contact_id","Contact","model","Photo"],"mappings":";;;;;;;AAAA;;;;;;AAEA,IAAIA,GAAJ;AACA,IAAIC,QAAQC,GAAR,CAAYC,WAAhB,EAA6B;AACzBH,UAAMC,QAAQC,GAAR,CAAYC,WAAlB;AACH,CAFD,MAEO;AACHH,UAAM,gCAAN;AACH;AACDI,mBAASC,OAAT,CAAiBL,GAAjB,EAAsB,EAAEM,iBAAiB,IAAnB,EAAyBC,oBAAoB,IAA7C,EAAtB;;AAEA,MAAMC,gBAAgB,IAAIJ,mBAASK,MAAb,CAAoB;AACtCC,SAAMC,MADgC;AAEtCC,UAAMD,MAFgC;AAGtCE,SAAKF,MAHiC;AAItCG,aAASH,MAJ6B;AAKtCI,WAAMJ;AALgC,CAApB,CAAtB;;AAQA,MAAMK,cAAc,IAAIZ,mBAASK,MAAb,CAAoB;AACpCC,SAAKC,MAD+B;AAEpCM,WAAOC,MAF6B;AAGpCC,cAAUR;AAH0B,CAApB,CAApB;;AAMA,IAAI,CAACH,cAAcY,OAAd,CAAsBC,QAA3B,EAAqC;AACjCb,kBAAcY,OAAd,CAAsBC,QAAtB,GAAiC,EAAjC;AACH;;AAEDb,cAAcc,GAAd,CAAkB,UAAlB,EAA8B;AAC1BC,eAAW,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AAC7BA,YAAIC,EAAJ,GAASD,IAAIf,GAAb;AACA,eAAOe,IAAIf,GAAX;AACA,eAAOe,IAAIE,GAAX;AACD;AALyB,CAA9B;;AAQAnB,cAAcoB,KAAd,CAAoB,EAAEhB,MAAK,CAAP,EAApB;AACAI,YAAYY,KAAZ,CAAkB,EAAEC,YAAW,CAAb,EAAlB;;AAEA,MAAMC,UAAU1B,mBAAS2B,KAAT,CAAe,UAAf,EAA2BvB,aAA3B,CAAhB;AACA,MAAMwB,QAAQ5B,mBAAS2B,KAAT,CAAe,QAAf,EAAyBf,WAAzB,CAAd;;QAESc,O,GAAAA,O;QAASE,K,GAAAA,K;QAAO5B,Q,GAAAA,kB","file":"testdb.js","sourcesContent":["import mongoose from 'mongoose';\r\n\r\nlet url;\r\nif (process.env.MONGODB_URI) {\r\n    url = process.env.MONGODB_URI;\r\n} else {\r\n    url = \"mongodb://localhost:27017/test\";\r\n}\r\nmongoose.connect(url, { useNewUrlParser: true, useUnifiedTopology: true })\r\n\r\nconst contactSchema = new mongoose.Schema({\r\n    _id : String, \r\n    name: String,\r\n    tel: String,\r\n    address: String,\r\n    photo:String\r\n})\r\n\r\nconst photoSchema = new mongoose.Schema({\r\n    _id: String,\r\n    image: Buffer, \r\n    mimetype: String \r\n})\r\n\r\nif (!contactSchema.options.toObject) {\r\n    contactSchema.options.toObject = {};\r\n}\r\n\r\ncontactSchema.set('toObject', {\r\n    transform: function (doc, ret) {\r\n      ret.no = ret._id\r\n      delete ret._id\r\n      delete ret.__v\r\n    }\r\n})\r\n\r\ncontactSchema.index({ name:1 })\r\nphotoSchema.index({ contact_id:1 })\r\n\r\nconst Contact = mongoose.model(\"contacts\", contactSchema);\r\nconst Photo = mongoose.model(\"photos\", photoSchema);\r\n\r\nexport { Contact, Photo, mongoose };\r\n"]}