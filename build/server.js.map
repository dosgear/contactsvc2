{"version":3,"sources":["../src/server.js"],"names":["app","use","enable","req","res","next","header","baseDir","path","resolve","logDirectory","join","fs","existsSync","mkdirSync","accessLogStream","interval","stream","set","process","env","PORT","express","static","console","log","engine","require","renderFile","bodyParser","json","urlencoded","extended","server","listen","get"],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,MAAMA,MAAM,wBAAZ;;AAEAA,IAAIC,GAAJ,CAAQ,qBAAR;AACAD,IAAIE,MAAJ,CAAW,gBAAX,E,CAAgC;;AAEhCF,IAAIC,GAAJ,CAAQ,UAAUE,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAC9BD,QAAIE,MAAJ,CAAW,eAAX,EAA4B,8CAA5B;AACAF,QAAIE,MAAJ,CAAW,SAAX,EAAsB,IAAtB;AACAF,QAAIE,MAAJ,CAAW,QAAX,EAAqB,UAArB;AACAD;AACH,CALD;;AAOA;AACA,IAAIE,UAAUC,eAAKC,OAAL,CAAa,GAAb,CAAd;;AAEA,MAAMC,eAAeF,eAAKG,IAAL,CAAUJ,OAAV,EAAmB,MAAnB,CAArB;AACAK,aAAGC,UAAH,CAAcH,YAAd,KAA+BE,aAAGE,SAAH,CAAaJ,YAAb,CAA/B;AACA,IAAIK,kBAAkB,kCAAI,YAAJ,EAAkB;AACtCC,cAAU,IAD4B,EACtB;AAChBR,UAAME;AAFgC,CAAlB,CAAtB;AAIAV,IAAIC,GAAJ,CAAQ,oBAAO,UAAP,EAAmB,EAACgB,QAAQF,eAAT,EAAnB,CAAR;;AAEAf,IAAIkB,GAAJ,CAAQ,MAAR,EAAiBC,QAAQC,GAAR,CAAYC,IAAZ,IAAoB,IAArC;;AAEArB,IAAIC,GAAJ,CAAQqB,kBAAQC,MAAR,CAAehB,UAAU,SAAzB,CAAR;AACAiB,QAAQC,GAAR,CAAYlB,UAAU,QAAtB;AACAP,IAAIkB,GAAJ,CAAQ,OAAR,EAAiBX,UAAU,QAA3B;AACAP,IAAIkB,GAAJ,CAAQ,aAAR,EAAuB,KAAvB;AACAlB,IAAI0B,MAAJ,CAAW,MAAX,EAAmBC,QAAQ,KAAR,EAAeC,UAAlC;AACA5B,IAAIC,GAAJ,CAAQ4B,qBAAWC,IAAX,EAAR;AACA9B,IAAIC,GAAJ,CAAQ4B,qBAAWE,UAAX,CAAsB;AAC5BC,cAAU;AADkB,CAAtB,CAAR;AAGAhC,IAAIC,GAAJ,CAAQ,UAAUE,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAC9BD,QAAIE,MAAJ,CAAW,eAAX,EAA4B,8CAA5B;AACAF,QAAIE,MAAJ,CAAW,SAAX,EAAsB,IAAtB;AACAF,QAAIE,MAAJ,CAAW,QAAX,EAAqB,UAArB;AACAD;AACH,CALD;;AAOA,sBAAOL,GAAP;;AAEA,MAAMiC,SAASjC,IAAIkC,MAAJ,CAAWlC,IAAImC,GAAJ,CAAQ,MAAR,CAAX,EAA4B,YAAW;AAClDX,YAAQC,GAAR,CAAY,cAAczB,IAAImC,GAAJ,CAAQ,MAAR,CAAd,GAAgC,iBAA5C;AACH,CAFc,CAAf","file":"server.js","sourcesContent":["import express from 'express';\r\nimport bodyParser from 'body-parser';\r\nimport cors from 'cors';\r\nimport morgan from 'cors';\r\nimport path from 'path';\r\nimport fs from 'fs';\r\nimport rfs from 'rotating-file-stream';\r\nimport routes from './routes';\r\n\r\nconst app = express();\r\n\r\napp.use(cors());\r\napp.enable(\"jsonp callback\");   //jsonp 지원\r\n\r\napp.use(function (req, res, next) {\r\n    res.header('Cache-Control', 'private, no-cache, no-store, must-revalidate');\r\n    res.header('Expires', '-1');\r\n    res.header('Pragma', 'no-cache');\r\n    next()\r\n});\r\n\r\n//-- 로깅\r\nvar baseDir = path.resolve('.');\r\n\r\nconst logDirectory = path.join(baseDir, '/log')\r\nfs.existsSync(logDirectory) || fs.mkdirSync(logDirectory)\r\nvar accessLogStream = rfs('access.log', {\r\n  interval: '1d', // 매일 매일 로그 파일 생성\r\n  path: logDirectory\r\n})\r\napp.use(morgan('combined', {stream: accessLogStream}))\r\n\r\napp.set('port', (process.env.PORT || 3000));\r\n\r\napp.use(express.static(baseDir + '/public'));\r\nconsole.log(baseDir + '/views');\r\napp.set('views', baseDir + '/views');\r\napp.set('view engine', 'ejs');\r\napp.engine('html', require('ejs').renderFile);\r\napp.use(bodyParser.json());\r\napp.use(bodyParser.urlencoded({\r\n  extended: true\r\n}));\r\napp.use(function (req, res, next) {\r\n    res.header('Cache-Control', 'private, no-cache, no-store, must-revalidate');\r\n    res.header('Expires', '-1');\r\n    res.header('Pragma', 'no-cache');\r\n    next()\r\n});\r\n\r\nroutes(app);\r\n\r\nconst server = app.listen(app.get('port'), function() {\r\n    console.log(\"연락처 서비스가 \" + app.get('port') + \"번 포트에서 시작되었습니다!\");\r\n});\r\n\r\n\r\n\r\n"]}