{"version":3,"sources":["../src/server.js"],"names":["app","use","enable","req","res","next","header","baseDir","path","resolve","logDirectory","join","fs","existsSync","mkdirSync","rfs","require","accessLogStream","createStream","interval","stream","set","process","env","PORT","express","static","console","log","engine","renderFile","bodyParser","json","urlencoded","extended","server","listen","get"],"mappings":";;AAAA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;;;AAEA,MAAMA,MAAM,wBAAZ;;AAEAA,IAAIC,GAAJ,CAAQ,qBAAR;AACAD,IAAIE,MAAJ,CAAW,gBAAX,E,CAAgC;;AAEhCF,IAAIC,GAAJ,CAAQ,UAAUE,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAC9BD,QAAIE,MAAJ,CAAW,eAAX,EAA4B,8CAA5B;AACAF,QAAIE,MAAJ,CAAW,SAAX,EAAsB,IAAtB;AACAF,QAAIE,MAAJ,CAAW,QAAX,EAAqB,UAArB;AACAD;AACH,CALD;;AAOA;AACA,IAAIE,UAAUC,eAAKC,OAAL,CAAa,GAAb,CAAd;;AAEA,MAAMC,eAAeF,eAAKG,IAAL,CAAUJ,OAAV,EAAmB,MAAnB,CAArB;AACAK,aAAGC,UAAH,CAAcH,YAAd,KAA+BE,aAAGE,SAAH,CAAaJ,YAAb,CAA/B;AACA,MAAMK,MAAMC,QAAQ,sBAAR,CAAZ;AACA,IAAIC,kBAAkBF,IAAIG,YAAJ,CAAiB,YAAjB,EAA+B;AACnDC,cAAU,IADyC,EACnC;AAChBX,UAAME;AAF6C,CAA/B,CAAtB;AAIAV,IAAIC,GAAJ,CAAQ,oBAAO,UAAP,EAAmB,EAACmB,QAAQH,eAAT,EAAnB,CAAR;;AAEAjB,IAAIqB,GAAJ,CAAQ,MAAR,EAAiBC,QAAQC,GAAR,CAAYC,IAAZ,IAAoB,IAArC;;AAEAxB,IAAIC,GAAJ,CAAQwB,kBAAQC,MAAR,CAAenB,UAAU,SAAzB,CAAR;AACAoB,QAAQC,GAAR,CAAYrB,UAAU,QAAtB;AACAP,IAAIqB,GAAJ,CAAQ,OAAR,EAAiBd,UAAU,QAA3B;AACAP,IAAIqB,GAAJ,CAAQ,aAAR,EAAuB,KAAvB;AACArB,IAAI6B,MAAJ,CAAW,MAAX,EAAmBb,QAAQ,KAAR,EAAec,UAAlC;AACA9B,IAAIC,GAAJ,CAAQ8B,qBAAWC,IAAX,EAAR;AACAhC,IAAIC,GAAJ,CAAQ8B,qBAAWE,UAAX,CAAsB;AAC5BC,cAAU;AADkB,CAAtB,CAAR;AAGAlC,IAAIC,GAAJ,CAAQ,UAAUE,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAC9BD,QAAIE,MAAJ,CAAW,eAAX,EAA4B,8CAA5B;AACAF,QAAIE,MAAJ,CAAW,SAAX,EAAsB,IAAtB;AACAF,QAAIE,MAAJ,CAAW,QAAX,EAAqB,UAArB;AACAD;AACH,CALD;;AAOA,sBAAOL,GAAP;;AAEA,MAAMmC,SAASnC,IAAIoC,MAAJ,CAAWpC,IAAIqC,GAAJ,CAAQ,MAAR,CAAX,EAA4B,YAAW;AAClDV,YAAQC,GAAR,CAAY,cAAc5B,IAAIqC,GAAJ,CAAQ,MAAR,CAAd,GAAgC,iBAA5C;AACH,CAFc,CAAf","file":"server.js","sourcesContent":["import express from 'express';\r\nimport bodyParser from 'body-parser';\r\nimport cors from 'cors';\r\nimport morgan from 'cors';\r\nimport path from 'path';\r\nimport fs from 'fs';\r\nimport routes from './routes';\r\n\r\nconst app = express();\r\n\r\napp.use(cors());\r\napp.enable(\"jsonp callback\");   //jsonp 지원\r\n\r\napp.use(function (req, res, next) {\r\n    res.header('Cache-Control', 'private, no-cache, no-store, must-revalidate');\r\n    res.header('Expires', '-1');\r\n    res.header('Pragma', 'no-cache');\r\n    next()\r\n});\r\n\r\n//-- 로깅\r\nvar baseDir = path.resolve('.');\r\n\r\nconst logDirectory = path.join(baseDir, '/log')\r\nfs.existsSync(logDirectory) || fs.mkdirSync(logDirectory)\r\nconst rfs = require(\"rotating-file-stream\");\r\nvar accessLogStream = rfs.createStream('access.log', {\r\n  interval: '1d', // 매일 매일 로그 파일 생성\r\n  path: logDirectory\r\n})\r\napp.use(morgan('combined', {stream: accessLogStream}))\r\n\r\napp.set('port', (process.env.PORT || 3000));\r\n\r\napp.use(express.static(baseDir + '/public'));\r\nconsole.log(baseDir + '/views');\r\napp.set('views', baseDir + '/views');\r\napp.set('view engine', 'ejs');\r\napp.engine('html', require('ejs').renderFile);\r\napp.use(bodyParser.json());\r\napp.use(bodyParser.urlencoded({\r\n  extended: true\r\n}));\r\napp.use(function (req, res, next) {\r\n    res.header('Cache-Control', 'private, no-cache, no-store, must-revalidate');\r\n    res.header('Expires', '-1');\r\n    res.header('Pragma', 'no-cache');\r\n    next()\r\n});\r\n\r\nroutes(app);\r\n\r\nconst server = app.listen(app.get('port'), function() {\r\n    console.log(\"연락처 서비스가 \" + app.get('port') + \"번 포트에서 시작되었습니다!\");\r\n});\r\n\r\n\r\n\r\n"]}